if(void 0===browser&&"undefined"!=typeof chrome)var browser=chrome;const isPwdInputVisibleOnThePage=()=>{const e=document.querySelectorAll('input[type*="password" i]');for(var t=0;t<e.length;t++)if(isElementVisible(e[t]))return 1;return 0},isElementHidden=e=>{try{return null===e.offsetParent}catch{return!0}},isElementVisible=e=>{if(!e)return!1;var t=getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&e.offsetWidth>0&&e.offsetHeight>0},captureAllFormsHtml=()=>{const e=[],t=document.querySelectorAll("form");for(var n=0;n<t.length;n++)isElementVisible(t[n])&&e.push(t[n].outerHTML);return e},observeDOM=function(){let e=window.MutationObserver||window.WebKitMutationObserver;return window.addEventListener,function(t,n){e&&new e((function(e,t){try{n()}catch(e){console.log(`mutation error: ${e.message}`)}})).observe(t,{childList:!0,subtree:!0,attributes:!0,characterData:!1})}}(),detectIframe=()=>{try{return window.self!==window.top}catch(e){return!0}},createMessagesPlaceholder=()=>{if(0===document.querySelectorAll("#gen-live-phishing-protection-extension-note").length){const e=document.createElement("div");e.setAttribute("id","gen-live-phishing-protection-extension-note"),e.style.display="none",e.innerHTML=`<div class="nrg-inner-container">\n    <img id="close" alt="X" src="${browser.extension.getURL("images/cross_32.png")}"  />\n        <img style="width: 24px;height: 24px;margin-top: 8.5px;float:left;margin-left: 15px;" alt="NRG" src="${browser.extension.getURL("images/icon48.png")}"  />\n        <span data-from="" data-to="" data-linktext="" data-reason="" id="nrg-message"></span>\n        <div class="nrg-dropdown">\n        <input type="button" value="Options" style="padding: 5px!important; width: 80px!important;font-weight: normal!important;" />\n            <div class="nrg-dropdown-content">\n            <ul>\n                <li style="margin-left: 0px!important;" id="report-as-phishing">Report this Web page as Phishing.</li>\n                <li style="margin-left: 0px!important;" id="report-as-not-phishing">Report this Web page as <b>Not</b> Phishing.</li>\n            </ul>\n            <div class="desc"></div>\n            </div>\n        </div>\n    </div>`;const t=setInterval((()=>{try{document.body.appendChild(e),document.querySelector("#gen-live-phishing-protection-extension-note #close").addEventListener("click",(function(){document.querySelector("#gen-live-phishing-protection-extension-note").style.display="none"})),clearInterval(t),searchLoginForms()}catch{}}),500)}},searchLoginForms=()=>{isPwdInputVisibleOnThePage()?browser.runtime.sendMessage({action:"domLoaded",capturedUrl:window.location.href}):furtherSearchLoginForms()},furtherSearchLoginForms=()=>{const e=captureAllFormsHtml();e&&e.length>0&&browser.runtime.sendMessage({action:"classifyForms",formsHtml:e,capturedUrl:window.location.href})},showMessage=e=>{const t=1==e?"This might be a phishing website.":"This does not seem to be a phishing website.",n=document.querySelector("#gen-live-phishing-protection-extension-note #nrg-message");n&&(n.innerHTML=`${t}`,document.querySelector("#gen-live-phishing-protection-extension-note").style.display="inline-block")};(()=>{const e=detectIframe();console.log("Phisherman loaded..."),0==e&&createMessagesPlaceholder(),browser.runtime.onMessage.addListener((function(e){try{void 0!==e.verdict&&showMessage(e.verdict)}catch(e){console.log(`Phisherman runtime error: ${e.message}`)}}))})();